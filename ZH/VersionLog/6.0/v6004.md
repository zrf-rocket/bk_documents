## 版本信息

|后台模块|6.0.3 版本|6.0.4 版本|
|---|---|---|
|bkiam|1.6.1|1.7.7|
|bklog|4.2.580|4.2.645|
|bkmonitorv3|3.3.1212|3.3.1449|
|bknodeman|2.0.847|2.0.927|
|bkssm|1.0.8|-|
|cmdb|3.9.22|3.9.27|
|fta|5.2.10|5.2.13|
|gse|3.5.16|3.5.16.2|
|job|3.2.7.3|-|
|license|3.1.5|-|
|open_paas|2.12.10|2.12.25|
|paas_agent|3.2.2|3.2.3|
|usermgr|2.2.5-1|2.2.6-b3|
|lesscode|-|0.0.11|

|SaaS|6.0.3 版本|6.0.4 版本|
|---|---|---|
|bk_iam|1.3.4|1.4.24|
|bk_log_search|4.2.580|4.2.645|
|bk_monitorv3|3.3.1731|3.3.1931|
|bk_nodeman|2.0.1548|2.0.1615|
|bk_sops|3.6.38|3.6.4206|
|bk_itsm|2.5.8.281|2.5.8.306|
|bk_fta_solutions|5.2.14|-|
|bk_user_manage|2.2.5|2.2.6|

|采集器|6.0.3 版本|6.0.4 版本|
|---|---|---|
|basereport|10.8.51|10.9.57|
|processbeat|1.16.62|1.16.63|
|exceptionbeat|1.4.33|1.6.40|
|bkmonitorbeat|1.12.92|1.14.105|
|bkmonitorproxy|1.1.34|1.2.43|
|bkunifylogbeat|7.2.65|7.2.77|
|pluginscripts|1.0.3|-|
|gsecmdline|2.0.3|-|

## 版本日志

### 部署脚本
- 【新增】lesscode 部署方式
- 【修复】单机部署执行 tweak 操作后 cheaper > workers 的问题
- 【修复】单机部署自定义目录问题
- 【优化】 JOB启动超时问题

### PaaS 平台
- 【新增】 ESB 组件 API 新增 get_weixin_config
- 【新增】PaaS/Console 通过组件 API get_weixin_config 获取微信配置

### 可视化开发平台

  - 【新增】新增 [@blueking/bkcharts](https://www.npmjs.com/package/@blueking/bkcharts)
  - 【新增】Element 基础组件库组件丰富
  - 【新增】支持函数的导入导出
  - 【新增】删除权限增加是否为数据的创造者的判断逻辑
  - 【新增】复合组件更新
  - 【修复】属性面板多类型属性值切换类型 tab 时，保留编辑的值
  - 【修复】其他体验 bug 修复以及优化

### 权限中心
- 【新增】权限模板去除实例绑定
- 【新增】用户组添加模板时关联实例权限 
- 【新增】用户组支持添加自定义权限
- 【优化】「我的权限」页面展示优化
- 【优化】依赖操作交互优化
- 【优化】申请用户组时支持按照分级管理员过滤
- 【新增】页面化接入，支持权限模型的配置生成
- 【优化】分级管理员切换身份交互优化
- 【新增】用户组权限支持删除单个自定义权限
- 【修复】分级管理员里推荐权限问题
- 【修复】搜索条件缓存问题


### 管控平台
- 【优化】btsvr.conf 配置模板的 "filesvrthriftip" 由 \_\_LAN_IP\_\_ 调整为 "0.0.0.0"
- 【优化】data.conf 配置模板的 "datasvrip" 由 \_\_LAN_IP\_\_ 调整为 "0.0.0.0"
- 【修复】gse_procmgr 和 gse_syncdata 在 gse_task 重启时的异常

### 监控平台

- 【新增】事件详情新增快速跳转日志检索的链接
- 【新增】新增单指标智能异常检测（依赖计算平台3.5.2+）
- 【新增】告警通知模版增加主机备注信息
- 【新增】告警组新增悬浮提示
- 【新增】新增基于CMDB节点数据聚合能力
- 【优化】支持监控基于ip下发的采集，配置的策略可以通知到主备负责人
- 【优化】恢复通知不展示异常数据
- 【优化】支持SNMP采集功能，包括snmp trap和主动snmp采集
- 【优化】图表多选功能扩展
- 【优化】主机进程信息接口缓存用以提高主机列表打开速度
- 【优化】监控主机列表过滤掉无内网IP的机器
- 【修复】修复拨测分类自定义事件策略报错问题
- 【修复】修复新建拨测任务页链接及缓存问题
- 【修复】修复IP搜索无法搜索服务类型策略的问题
- 【修复】修复数据检索维度为空的问题
- 【修复】修复策略详情无法获取指标后无法获取维度问题
- 【修复】修复自定义事件被删除后策略页面报错问题
- 【修复】拨测任务克隆时补充创建者和编辑者
- 【修复】服务实例屏蔽失效问题处理
- 【修复】修复拨测左侧列表页展示可用性不准确的问题
- 【修复】修复自定义事件策略详情无法回填问题
- 【修复】告警屏蔽不支持跨天时间段问题处理
- 【修复】修复主机列表树形组件宽度自适应问题

### 日志平台

- 【新增】检索单元格增加复制图标
- 【新增】过滤条件字段显示别名
- 【新增】检索页双击表格行复制
- 【优化】检索页图表库
- 【优化】获取索引集 mapping 性能
- 【优化】可以根据采集项自定义调整 ES 存储配置
- 【优化】新建及编辑集群模板性能优化
- 【优化】提取文件名支持~符号
- 【优化】预览文件支持自定义时间范围
- 【优化】日志提取拓扑搜索时展示匹配项子节点
- 【优化】打包脚本参数传递优化 支持大量文件列表参数渲染
- 【修复】过滤条件在显示别名情况下检索异常的问题
- 【修复】上下文log为空值时显示kv数据的问题
- 【修复】不启动链路功能后无法创建采集项的问题
- 【修复】采集配置分隔符渲染导致部分采集项上报异常的问题
- 【修复】采集项字段变更后无法创建索引集的问题
- 【修复】不启动链路功能后无法创建采集项的问题
- 【修复】字段提取由于日志内容过长导致解析异常的问题
- 【修复】第三方集群索引集创建及更新偶现无法获取字段问题
- 【修复】调用 job 平台查询文件列表异常时未捕获问题

### 故障自愈
- 【修复】后台变量无法使用主机名

### 节点管理
- 【修复】统计接口适配主机不匹配情况
- 【修复】修复停止插件状态不同步问题

### 配置平台

- 【新增】服务模板同步对比接口支持返回上 service_template_id 值
- 【新增】主机快照采集支持 mac地址去重
- 【新增】操作审计名称查询默认精确查找
- 【新增】主机搜索接口支持按时间搜索
- 【新增】主机/实例查询支持时间范围
- 【新增】模型实例长短字符支持精确/模糊搜索切换
- 【新增】新增 apimachinery 中2个 metrics指标
- 【新增】操作审计的 `账号` 字段现在支持 `in` 和 `not in` 两种查询条件
- 【新增】主机模型内置属性【操作系统类型】增加 UNIX
- 【新增】小工具增加对 DB 的操作，目前支持查找、删除和显示指定 DB 的所有 Collections
- 【新增】增加事件链路检查和升级 gsecmdline 命令

- 【优化】 时间类型字段兼容带时区的格式
- 【优化】 优化批量更新主机接口的鉴权性能
- 【优化】 实例时间字段格式化，避免提交UTC格式
- 【优化】 移除遗留的 metadata 兼容逻辑
- 【优化】 对模型字段正则校验文本进行前置校验
- 【优化】 拓扑缓存管理支持按ID进行排序管理，并去重
- 【优化】 对齐了服务模板和业务拓扑的命名规则，避免生成实例时因规则不同导致数据错误
- 【优化】 改进主机移动模块的功能交互逻辑，增加 `追加` 和 `移出` 两个操作入口，满足对指定主机增量更新拓扑归属的需求
- 【优化】 服务实例的进程别名现在支持修改了
- 【优化】 现在对主机筛选后的表格字段会在用户自定义显示字段基础上新增，而非重置
- 【优化】 进程的 `启动优先级` 数值设置范围调整为 `-100 ~ 10000`
- 【优化】 调整查询审计列表逻辑中对传参的判断逻辑，拆分新老参数判断方式
- 【优化】 为了更好的提高兼容性和扩展能力，调整 ES 检索接口协议，优化入参和结果
- 【优化】 现在当服务模板内有实例未更新同步时，在列表处会有 `小红点` 的提示了
- 【优化】 为 `目标模型` 选择器添加了搜索的能力，优化因模型太多不好选中的体验
- 【优化】 去除模型搜索结果没有匹配的分组显示，简化了搜索结果的体验
- 【优化】 模板/拓扑节点名称校验规则更新
- 【优化】 查询服务模版同步状态的接口添加 auth parser
- 【优化】 动态分组支持主机的云区域字段
- 【优化】 开放进程模板别名修改
- 【优化】 调整通用模型实例表的es索引名
- 【优化】 UI: 去除业务拓扑服务实例表格的行吸顶效果
- 【优化】 UI: 主机属性不可编辑状态在自动应用的完善
- 【优化】 UI: 主机表格显示字段由切换显示筛选字段变更为追加显示
- 【优化】 UI: 修改业务拓扑移出菜单显示判断逻辑
- 【优化】 一些常规的 UI / UX 优化...

- 【修复】 修复创建默认服务分类所在的upgrader失败时重复创建多个服务分类的问题
- 【修复】 属性自动应用启停判断修正
- 【修复】 修复在zk连接失败的情况下多次重连产生多个连接的问题
- 【修复】 修复导入模型异常问题
- 【修复】 升级click-outside指令，解决服务分类/资源目录无法操作的问题
- 【修复】 修复长短字符搜索组件无法粘贴的问题
- 【修复】 修复集群被删除后， 集群同步表数据还存在，依然展示在集群模板实例中展示
- 【修复】 修复集群同步表中没有集群同步市局的时候，在集群模板实例中不显示
- 【修复】 修复 es 检索不到通用模型实例的问题
- 【修复】 修复主机自定义显示列加载时不显示模块名/集群名的问题
- 【修复】 修复模型管理实例字段字段排序设置组件未正确渲染的问题
- 【修复】 修复主机筛选部分组件输入框被操作按钮遮挡的问题
- 【修复】 修复删除事务在部分场景下无法正常入库的问题 
- 【修复】 修复在空闲机模块下转移主机到自身时，出现主机数 count 不准确的问题
- 【修复】 解决全文检索的查询结果中命中了 `模型` 数据，但没有正常显示标签页的问题
- 【修复】 解决业务自定义时间类型字段无法正常作用于动态分组的问题
- 【修复】 解决批量编辑场景下，时间类型字段异常报错的问题
- 【修复】 修复集群模板实例展示的问题
- 【修复】 UI: 修复操作审计详情未显示业务自定义字段的问题
- 【修复】 UI: 修复模型管理唯一标识不可见的问题
- 【修复】 UI: 修复操作审计入参错误的问题
- 【修复】 UI: 修复集群节点信息跳转链接失败的问题
- 【修复】 UI: 修复动态分组预览未显示完整表格的问题
- 【修复】 UI: 修复服务模板编辑后显示提示信息失败的问题

### 标准运维
- 【修复】 子流程更新时下拉框变量选项同步失败的问题

### 流程服务
- 【修复】 创建任务时字段显示异常
- 【修复】 API节点array类型数据格式不正确问题修复
- 【优化】 移动端跳转链接优化
- 【优化】 企业微信跳转链接修改
- 【优化】 网关接口支持post分页

### 用户管理
- 【新增】增加 "查看" 类权限项
- 【新增】增加用户登录审计
- 【新增】审计信息增加客户端来源 IP
- 【优化】支持 LDAP/AD 数据分页拉取，绕开 1000 条数量限制
- 【优化】支持用户重置密码不能与最近三次密码重复
- 【优化】支持后台环境变量配置，启停全局邮件通知

### 采集器
- basereport
  - 【修复】解决 basereport 采集时卡主导致调度周期出现异常 数据断点的问题
- processbeat
  - 【修复】 netlink获取信息结束的判断逻辑，改为通过消息类型判断，而非判断消息为空
  - 【修复】 在netlink被废弃的时候，第一次获取命令信息也不会使用netlink
- exceptionbeat
  - 【修复】当/proc/vmstat中存在oom_kill关键字时，会导致持续oom告警发送
- bkmonitorbeat
  - 【优化】切割通过 Prometheus 抓取的大指标，避免因数据量过大而被截断的问题
- bkmonitorproxy
  - 【优化】提供数据上报校验功能，包括数据格式和数据类型的校验
  - 【新增】提供 consul 域名注册上报功能
- bkunifylogbeat
  - 【新增】兼容bklogbeat、unifyTlogc配置及输出
  - 【新增】文件采集支持软链
  - 【新增】采集器任务管理按任务hash去重
  - 【修复】修复文件监听删除或过期后未移除采集进度的问题
  - 【修复】修复windows采集器reload异常的问题
  - 【优化】采集器默认监听最近7天的变更的文件

