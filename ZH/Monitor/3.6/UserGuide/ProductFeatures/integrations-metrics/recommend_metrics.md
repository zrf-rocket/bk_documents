
## 1. 时序数据库介绍

时序数据是一种针对时序数据专门优化的数据库，主要有以下几个特性：
    
- 对批量写有专门优化。以蓝鲸监控平台为例，目前默认可以支持每秒10k级别的写入速度
- 数据自动索引。与关系型数据库比较，时序数据库写入数据默认区分字段类型是指标还是维度。时序数据将自动对维度字段进行索引，免去表结构维护动作，方便使用者利用维度字段进行聚合和查询过滤。
- 指标数据存储压缩。由于时序数据维度不变的特性，所以时序数据库多使用列式存储模式，可以实现可观的数据压缩比。以蓝鲸监控平台主机监控数据为例，我们20万台主机存储30天占用了15TB数据，平均每台主机每天使用磁盘空间为2MB
- 由于时序数据库默认会对维度字段进行索引，所以维度组合数量会极大影响时序数据的性能。维度组合：是指时序数据中维度名和值去重后的组合数量。例如：

    ```
usage{ip="10.0.1.0"} 100
usage{ip="10.0.1.1"} 200
usage{ip="10.0.1.0"} 300
```
    
    其中，`ip`字段值去重后，只有`10.0.1.0`和`10.0.1.1`，维度组合数为2。所以，我们强烈不建议将具有随机性质的属性作为维度上报，例如：请求ID、时间、用户ID等。

## 2. 默认支持量级

监控平台提供默认存储实例可以支持：

- 维度组合总量不超过10m
- 维度组合增长率需要控制在每分钟100以下
- 指标数量不超过5k
- 每秒上报指标点不超过10k

如上报数据在此范围以外，需要做存储上的拆分了。

## 3. 常见优化手段

- 如果指标量过多，请确认上报指标名中是否含有维度信息。例如：`cpu_0_usage 100`表示CPU0的单核使用率。该指标应该改为usage{cpu="0"} 100。
- 如果发现维度组合过多，请确认维度信息是否存在非必要信息。例如：`memory_usage{room_id="585bcc656d", room_type="battle", instanceID="0.1.0.1"} 50`表示实例ID为0.1.0.1、监听端口为5260、房间ID为585bcc656d进程内存使用率为50%。但是由于房间ID是一个随机值，容易导致时序数据库索引压力过大。此时，建议可以将room_id指标去掉。

