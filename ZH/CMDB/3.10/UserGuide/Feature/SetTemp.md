# 集群模版

集群模板可以定义业务通用的集群结构，用于[业务拓扑](./BusinessTopology.md)中快速部署和维护集群。此功能依赖已经存在[服务模板](./ServiceTemp.md)。

## 创建集群模版

进入“业务-集群模版”，点击“创建”新建集群模版。

![image-20220923205415153](media/image-20220923205415153.png)
<center>图1：开始集群模版</center>

集群模板主要有三块信息组成：

- 基础信息

  - 模版名称

    集群模版的标识，在使用的时候可以识别即可

- 属性设置

  集群的属性字段设置，同步配置到模板中，在生成集群实例时可以同时渲染并方便后续统一管理

- 集群拓扑

  用于设计该集群是由哪些模块构成的，而模块的生成方式也由其模板管理

![image-20220923205912840](media/image-20220923205912840.png)
<center>图2：集群模版编辑态</center>

![image-20220923210058510](media/image-20220923210058510.png)
<center>图3：查看集群模板生成的关联实例列表</center>

## 使用集群模版

进入到“业务-业务拓扑”，创建集群的时候，选择从模板创建，补充集群名称即可。

![image-20220923210218867](media/image-20220923210218867.png)
<center>图4：使用集群模板创建集群</center>

创建业务完成以后，可以看到在业务下已经创建了包含模块的拓扑，用户可以直接分配主机到拓扑中。

![image-20220923210457208](media/image-20220923210457208.png)
<center>图5：完成创建集群</center>

## 同步

集群模版的结构发生变化后，可以通过同步功能批量更新到集群实例中。

需要注意的是，同步操作是异步进行，在同步完成前，尽可能不要对当前集群做变更。

![image-20220923210630604](media/image-20220923210630604.png)
<center>图6：修改集群模版成功</center>

![image-20220923210742836](media/image-20220923210742836.png)
<center>图7：同步集群模版</center>

![image-20220923210803772](media/image-20220923210803772.png)
<center>图8：同步集群模版确认</center>

## 删除

为了保证配置的安全和准确，集群模版的删除，需要先清理已存在的关联集群。
