## 公共流程

公共流程通常由公共团队的成员来管理，用于管理希望在所有项目下都能够通用的基础流程，从而避免重复建设。

> 只有拥有公共流程管理权限（新建/编辑/删除）才能够进入【公共流程管理】：

![公共流程](../assets/image-20220913200012160.png)

### 在项目下查看和引用公共流程

公共流程的管理和项目流程完全相同。公共创建创建完成后，可在项目下的【公共流程】tab 查看并新建任务执行

![在项目查看公共流程](../assets/image-20220913204220130.png)

还可将公共流程作为子流程引用，从而实现将公共团队提供的原子流程和业务流程完成串联。

![引用公共流程](../assets/image-20220913204857054.png)

### 公共流程权限问题

要实现公共流程在项目下使用，公共流程提供方需要考虑使用者是否拥有对应的权限

- 标准运维：公共流程的使用者需要拥有【公共流程查看】、【公共流程新建任务】两个权限
- 其他系统：公共流程的使用者也受标准插件对接的后端系统权限约束

以「作业平台（JOB）」插件为例，**公共流程提供方**需考虑下面的约束：

- 作业平台默认只允许执行方案、脚本等资源和执行目标（IP）归属于同一个业务（集）
- 从其他业务机器传输文件，需要在 「作业平台 - 平台管理 - IP 白名单」中开启 “文件分发”的白名单
- 在其他业务机器执行脚本，需要在 「作业平台 - 平台管理 - IP 白名单」中开启 “脚本执行”的白名单

#### 案例：

两个使用中需要注意的地方：

- 公共流程提供方编辑公共流程时，无法获取实际执行所在的业务。我们需要将“业务”字段 “设置为变量”。当真正执行时，系统会自动填充为当前业务
- 目标服务器输入的 IP 需要属于当前业务。如非当前业务 IP，请以 云区域：IP 格式输入，并在 「作业平台 - 平台管理 - IP 白名单」中开启白名单

![1689057612859](image/common_flow/1689057612859.png)
