# 如何利用分支网关实现循环的效果

在工作场景中，我们有时需要循环执行一些步骤，此时可以用分支网关来实现循环的效果。
下面我们用循环来实现滚动执行的效果，针对一组 IP 挨个执行，而不是并行执行。

### 1. 将分支网关的其中一条分支连线到循环起始节点

![-w2020](../assets/循环.png)

### 2. 将起始节点的输出参数“循环次数”设置为全局变量，用于判断循环 继续/结束

![设置变量](../assets/循环变量.png)

### 3. 编写分支表达式 ，利用上一步输出的变量 $\{\_loop} 来设置继续循环和循环结束的条件

循环执行分支
![-w2020](../assets/循环未结束.png)

循环结束分支
![-w2020](../assets/循环已结束.png)

### 4. 循环遍历目标 IP

![-w2020](../assets/遍历IP.png)

Tips:可以配合变量语法来实现更高阶的用法

`使用${len(ips.split(",")}来获取IP的个数`
`使用${ips.split(",")[_loop-1]}来挨个遍历IP`
